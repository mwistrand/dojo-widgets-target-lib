{"version":3,"file":"/Users/mwistrand/projects/dojo/widgets/src/dialog/index.ts","sourceRoot":"","sources":["../node_modules/tslint-loader/index.js??ref--4!/Users/mwistrand/projects/dojo/widgets/node_modules/@dojo/webpack-contrib/css-module-dts-loader/index.js?type=ts&instanceName=0_custom-elements!/Users/mwistrand/projects/dojo/widgets/src/dialog/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { DNode } from '@dojo/framework/widget-core/interfaces';\nimport { WidgetBase } from '@dojo/framework/widget-core/WidgetBase';\nimport { I18nMixin } from '@dojo/framework/widget-core/mixins/I18n';\nimport { ThemedMixin, ThemedProperties, theme } from '@dojo/framework/widget-core/mixins/Themed';\nimport Focus from '@dojo/framework/widget-core/meta/Focus';\nimport { v, w } from '@dojo/framework/widget-core/d';\nimport { uuid } from '@dojo/framework/core/util';\nimport { CustomAriaProperties } from '../common/interfaces';\nimport { formatAriaProperties, Keys } from '../common/util';\nimport commonBundle from '../common/nls/common';\n\nimport Icon from '../icon/index';\nimport * as fixedCss from './styles/dialog.m.css';\nimport * as css from '../theme/dialog.m.css';\nimport { GlobalEvent } from '../global-event/index';\nimport { customElement } from '@dojo/framework/widget-core/decorators/customElement';\n\n/**\n * The role of this dialog, used for accessibility\n */\nexport type RoleType = 'dialog' | 'alertdialog';\n\n/**\n * @type DialogProperties\n *\n * Properties that can be set on a Dialog component\n *\n * @property closeable          Determines whether the dialog can be closed\n * @property closeText          Hidden text used by screen readers to display for the close button\n * @property enterAnimation     css class to be used when animating the dialog entering, or null to disable the animation\n * @property exitAnimation      css class to be used when animating the dialog exiting, or null to disable the animation\n * @property underlayEnterAnimation     css class to be used when animating the dialog underlay entering, or null to disable the animation\n * @property underlayExitAnimation      css class to be used when animating the dialog underlay exiting, or null to disable the animation\n * @property modal              Determines whether the dialog can be closed by clicking outside its content\n * @property onOpen             Called when the dialog opens\n * @property onRequestClose     Called when the dialog is closed\n * @property open               Determines whether the dialog is open or closed\n * @property role               Role of this dialog for accessibility, either 'alert' or 'dialog'\n * @property title              Title to show in the dialog title bar\n * @property underlay           Determines whether a semi-transparent background shows behind the dialog\n */\nexport interface DialogProperties extends ThemedProperties, CustomAriaProperties {\n\tcloseable?: boolean;\n\tcloseText?: string;\n\tenterAnimation?: string | null;\n\texitAnimation?: string | null;\n\tunderlayEnterAnimation?: string | null;\n\tunderlayExitAnimation?: string | null;\n\tmodal?: boolean;\n\tonOpen?(): void;\n\tonRequestClose?(): void;\n\topen?: boolean;\n\trole?: RoleType;\n\ttitle?: string;\n\tunderlay?: boolean;\n}\n\n@theme(css)\n@customElement<DialogProperties>({\n\ttag: 'dojo-dialog',\n\tproperties: [\n\t\t'theme',\n\t\t'aria',\n\t\t'extraClasses',\n\t\t'exitAnimation',\n\t\t'enterAnimation',\n\t\t'underlayEnterAnimation',\n\t\t'underlayExitAnimation',\n\t\t'closeable',\n\t\t'modal',\n\t\t'open',\n\t\t'underlay',\n\t\t'classes'\n\t],\n\tattributes: ['title', 'role', 'closeText'],\n\tevents: ['onOpen', 'onRequestClose']\n})\nexport class Dialog extends I18nMixin(ThemedMixin(WidgetBase))<DialogProperties> {\n\tprivate _titleId = uuid();\n\tprivate _wasOpen: boolean | undefined;\n\tprivate _callFocus = false;\n\tprivate _initialFocusSet = false;\n\n\tprivate _onCloseClick(event: MouseEvent) {\n\t\tevent.stopPropagation();\n\t\tthis._close();\n\t}\n\n\tprivate _checkFocus() {\n\t\tconst { modal, open } = this.properties;\n\n\t\t// only handle focus for open dialog\n\t\tif (!open) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialogFocus = this.meta(Focus).get('main');\n\t\tif (dialogFocus.containsFocus) {\n\t\t\tthis._callFocus = false;\n\t\t\tthis._initialFocusSet = true;\n\t\t}\n\n\t\t// handle if the dialog is open and loses focus\n\t\tif (this._initialFocusSet && !dialogFocus.containsFocus) {\n\t\t\tmodal ? (this._callFocus = true) : this._close();\n\t\t}\n\n\t\tif (this._callFocus) {\n\t\t\tthis.meta(Focus).set('main');\n\t\t}\n\t}\n\n\tprivate _close() {\n\t\tconst { closeable = true, onRequestClose } = this.properties;\n\n\t\tcloseable && onRequestClose && onRequestClose();\n\t}\n\n\tprivate _onUnderlayClick(event: MouseEvent) {\n\t\tevent.stopPropagation();\n\t\t!this.properties.modal && this._close();\n\t}\n\n\tprivate _onKeyUp = (event: KeyboardEvent): void => {\n\t\tevent.stopPropagation();\n\t\tif (event.which === Keys.Escape) {\n\t\t\tthis._close();\n\t\t}\n\t};\n\n\tprivate _onOpen() {\n\t\tconst { onOpen } = this.properties;\n\t\tthis._callFocus = true;\n\t\tthis._initialFocusSet = false;\n\t\tonOpen && onOpen();\n\t}\n\n\tprotected getContent(): DNode {\n\t\treturn v(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tclasses: this.theme(css.content),\n\t\t\t\tkey: 'content'\n\t\t\t},\n\t\t\tthis.children\n\t\t);\n\t}\n\n\tprotected renderTitle(): DNode {\n\t\tconst { title = '' } = this.properties;\n\t\treturn v('div', { id: this._titleId }, [title]);\n\t}\n\n\tprotected renderUnderlay(): DNode {\n\t\tconst {\n\t\t\tunderlay,\n\t\t\tunderlayEnterAnimation = this.theme(css.underlayEnter),\n\t\t\tunderlayExitAnimation = this.theme(css.underlayExit)\n\t\t} = this.properties;\n\t\treturn v('div', {\n\t\t\tclasses: [this.theme(underlay ? css.underlayVisible : null), fixedCss.underlay],\n\t\t\tenterAnimation: underlayEnterAnimation,\n\t\t\texitAnimation: underlayExitAnimation,\n\t\t\tkey: 'underlay',\n\t\t\tonclick: this._onUnderlayClick\n\t\t});\n\t}\n\n\tprotected render(): DNode {\n\t\tlet {\n\t\t\taria = {},\n\t\t\tcloseable = true,\n\t\t\tcloseText,\n\t\t\tenterAnimation = this.theme(css.enter),\n\t\t\texitAnimation = this.theme(css.exit),\n\t\t\topen = false,\n\t\t\trole = 'dialog',\n\t\t\ttitle = '',\n\t\t\ttheme,\n\t\t\tclasses\n\t\t} = this.properties;\n\n\t\topen && !this._wasOpen && this._onOpen();\n\t\tthis._wasOpen = open;\n\n\t\tthis._checkFocus();\n\n\t\tif (!closeText) {\n\t\t\tconst { messages } = this.localizeBundle(commonBundle);\n\t\t\tcloseText = `${messages.close} ${title}`;\n\t\t}\n\n\t\treturn v(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tclasses: this.theme([css.root, open ? css.open : null])\n\t\t\t},\n\t\t\topen\n\t\t\t\t? [\n\t\t\t\t\t\tw(GlobalEvent, { key: 'global', document: { keyup: this._onKeyUp } }),\n\t\t\t\t\t\tthis.renderUnderlay(),\n\t\t\t\t\t\tv(\n\t\t\t\t\t\t\t'div',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t...formatAriaProperties(aria),\n\t\t\t\t\t\t\t\t'aria-labelledby': this._titleId,\n\t\t\t\t\t\t\t\tclasses: this.theme(css.main),\n\t\t\t\t\t\t\t\tenterAnimation,\n\t\t\t\t\t\t\t\texitAnimation,\n\t\t\t\t\t\t\t\tkey: 'main',\n\t\t\t\t\t\t\t\trole,\n\t\t\t\t\t\t\t\ttabIndex: -1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tv(\n\t\t\t\t\t\t\t\t\t'div',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tclasses: this.theme(css.title),\n\t\t\t\t\t\t\t\t\t\tkey: 'title'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tthis.renderTitle(),\n\t\t\t\t\t\t\t\t\t\tcloseable\n\t\t\t\t\t\t\t\t\t\t\t? v(\n\t\t\t\t\t\t\t\t\t\t\t\t\t'button',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses: this.theme(css.close),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'button',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick: this._onCloseClick\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcloseText,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tw(Icon, {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'closeIcon',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclasses\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tthis.getContent()\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t)\n\t\t\t\t  ]\n\t\t\t\t: []\n\t\t);\n\t}\n}\n\nexport default Dialog;\n"]}