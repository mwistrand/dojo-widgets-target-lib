{"version":3,"file":"/Users/mwistrand/projects/dojo/widgets/src/grid/Cell.ts","sourceRoot":"","sources":["../node_modules/tslint-loader/index.js??ref--4!/Users/mwistrand/projects/dojo/widgets/node_modules/@dojo/webpack-contrib/css-module-dts-loader/index.js?type=ts&instanceName=0_custom-elements!/Users/mwistrand/projects/dojo/widgets/src/grid/Cell.ts"],"names":[],"mappings":"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","sourcesContent":["import WidgetBase from '@dojo/framework/widget-core/WidgetBase';\nimport { v, w } from '@dojo/framework/widget-core/d';\nimport { FocusMixin, FocusProperties } from '@dojo/framework/widget-core/mixins/Focus';\nimport ThemedMixin, { theme } from '@dojo/framework/widget-core/mixins/Themed';\nimport { DNode } from '@dojo/framework/widget-core/interfaces';\nimport { uuid } from '@dojo/framework/core/util';\nimport { Keys } from '../common/util';\nimport TextInput from '../text-input/index';\nimport Button from '../button/index';\nimport Icon from '../icon/index';\n\nimport * as fixedCss from './styles/cell.m.css';\nimport * as css from '../theme/grid-cell.m.css';\n\nexport interface CellProperties extends FocusProperties {\n\tvalue: string | DNode;\n\teditable?: boolean;\n\trawValue: string;\n\tupdater: (value: any) => void;\n}\n\n@theme(css)\nexport default class Cell extends ThemedMixin(FocusMixin(WidgetBase))<CellProperties> {\n\tprivate _editing = false;\n\tprivate _editingValue = '';\n\tprivate _focusKey: string;\n\tprivate _idBase = uuid();\n\n\tprivate _callFocus(key: string) {\n\t\tthis._focusKey = key;\n\t\tthis.focus();\n\t}\n\n\tprivate _onEdit = () => {\n\t\tconst { editable } = this.properties;\n\t\tif (editable) {\n\t\t\tthis._editing = true;\n\t\t\tthis._callFocus('input');\n\t\t\tthis._editingValue = this.properties.rawValue;\n\t\t\tthis.invalidate();\n\t\t}\n\t};\n\n\tprivate _onBlur() {\n\t\tif (this._editing) {\n\t\t\tthis._onSave();\n\t\t}\n\t}\n\n\tprivate _onInput(value: string) {\n\t\tthis._editingValue = value;\n\t}\n\n\tprivate _onKeyDown(key: number) {\n\t\tif (key === Keys.Enter) {\n\t\t\tthis._onSave();\n\t\t\tthis._callFocus('button');\n\t\t} else if (key === Keys.Escape) {\n\t\t\tthis._editing = false;\n\t\t\tthis._callFocus('button');\n\t\t\tthis.invalidate();\n\t\t}\n\t}\n\n\tprivate _onSave() {\n\t\tthis._editing = false;\n\t\tthis.properties.updater(this._editingValue);\n\t\tthis.invalidate();\n\t}\n\n\tprotected renderContent(): DNode {\n\t\tconst { value } = this.properties;\n\t\treturn v(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tkey: 'content',\n\t\t\t\tid: this._idBase,\n\t\t\t\tondblclick: this._onEdit\n\t\t\t},\n\t\t\t[value]\n\t\t);\n\t}\n\n\tprotected render(): DNode {\n\t\tlet { editable, rawValue, theme, classes } = this.properties;\n\n\t\treturn v('div', { role: 'cell', classes: [this.theme(css.root), fixedCss.rootFixed] }, [\n\t\t\tthis._editing\n\t\t\t\t? w(TextInput, {\n\t\t\t\t\t\tkey: 'input',\n\t\t\t\t\t\ttheme,\n\t\t\t\t\t\tclasses,\n\t\t\t\t\t\tlabel: `Edit ${rawValue}`,\n\t\t\t\t\t\tlabelHidden: true,\n\t\t\t\t\t\textraClasses: { input: this.theme(css.input) } as any,\n\t\t\t\t\t\tfocus: this._focusKey === 'input' ? this.shouldFocus : () => false,\n\t\t\t\t\t\tvalue: this._editingValue,\n\t\t\t\t\t\tonInput: this._onInput,\n\t\t\t\t\t\tonBlur: this._onBlur,\n\t\t\t\t\t\tonKeyDown: this._onKeyDown\n\t\t\t\t  })\n\t\t\t\t: this.renderContent(),\n\t\t\teditable && !this._editing\n\t\t\t\t? w(\n\t\t\t\t\t\tButton,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: 'button',\n\t\t\t\t\t\t\ttheme,\n\t\t\t\t\t\t\tclasses,\n\t\t\t\t\t\t\taria: { describedby: this._idBase },\n\t\t\t\t\t\t\tfocus: this._focusKey === 'button' ? this.shouldFocus : () => false,\n\t\t\t\t\t\t\ttype: 'button',\n\t\t\t\t\t\t\textraClasses: { root: this.theme(css.edit) } as any,\n\t\t\t\t\t\t\tonClick: this._onEdit\n\t\t\t\t\t\t},\n\t\t\t\t\t\t[w(Icon, { type: 'editIcon', altText: 'Edit', classes, theme })]\n\t\t\t\t  )\n\t\t\t\t: null\n\t\t]);\n\t}\n}\n"]}