{"version":3,"file":"/Users/mwistrand/projects/dojo/widgets/src/grid/Header.ts","sourceRoot":"","sources":["../node_modules/tslint-loader/index.js??ref--4!/Users/mwistrand/projects/dojo/widgets/node_modules/@dojo/webpack-contrib/css-module-dts-loader/index.js?type=ts&instanceName=0_custom-elements!/Users/mwistrand/projects/dojo/widgets/src/grid/Header.ts"],"names":[],"mappings":"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","sourcesContent":["import WidgetBase from '@dojo/framework/widget-core/WidgetBase';\nimport { v, w } from '@dojo/framework/widget-core/d';\nimport ThemedMixin, { theme } from '@dojo/framework/widget-core/mixins/Themed';\nimport { ColumnConfig, SortOptions } from './interfaces';\nimport { DNode } from '@dojo/framework/widget-core/interfaces';\nimport TextInput from '../text-input/index';\nimport Icon from '../icon/index';\n\nimport * as css from '../theme/grid-header.m.css';\nimport * as fixedCss from './styles/header.m.css';\n\nexport interface SortRenderer {\n\t(column: ColumnConfig, direction: undefined | 'asc' | 'desc', sorter: () => void): DNode;\n}\n\nexport interface FilterRenderer {\n\t(\n\t\tcolumn: ColumnConfig,\n\t\tfilterValue: string,\n\t\tdoFilter: (value: string) => void,\n\t\ttitle?: string | DNode\n\t): DNode;\n}\n\nexport interface HeaderProperties {\n\tcolumnConfig: ColumnConfig[];\n\tsorter: (columnId: string, direction: 'asc' | 'desc') => void;\n\tfilterer: (columnId: string, value: any) => void;\n\tfilter?: {\n\t\t[index: string]: string;\n\t};\n\tsort?: SortOptions;\n\tsortRenderer?: SortRenderer;\n\tfilterRenderer?: FilterRenderer;\n}\n\n@theme(css)\nexport default class Header extends ThemedMixin(WidgetBase)<HeaderProperties> {\n\tprivate _getColumnTitle(column: ColumnConfig): string | DNode {\n\t\tif (typeof column.title === 'function') {\n\t\t\treturn column.title();\n\t\t}\n\t\treturn column.title;\n\t}\n\n\tprivate _sortColumn(id: string) {\n\t\tconst { sort, sorter } = this.properties;\n\t\tconst direction = sort\n\t\t\t? sort.columnId !== id\n\t\t\t\t? 'desc'\n\t\t\t\t: sort.direction === 'desc'\n\t\t\t\t? 'asc'\n\t\t\t\t: 'desc'\n\t\t\t: 'desc';\n\t\tsorter(id, direction);\n\t}\n\n\tprivate _sortRenderer = (\n\t\tcolumn: ColumnConfig,\n\t\tdirection: undefined | 'asc' | 'desc',\n\t\tsorter: () => void\n\t) => {\n\t\tconst { theme, classes } = this.properties;\n\t\treturn v('button', { classes: this.theme(css.sort), onclick: sorter }, [\n\t\t\tw(Icon, {\n\t\t\t\ttheme,\n\t\t\t\tclasses,\n\t\t\t\ttype: direction === 'asc' ? 'upIcon' : 'downIcon',\n\t\t\t\taltText: `Sort by ${this._getColumnTitle(column)}`\n\t\t\t})\n\t\t]);\n\t};\n\n\tprivate _filterRenderer = (\n\t\tcolumnConfig: ColumnConfig,\n\t\tfilterValue: string,\n\t\tdoFilter: (value: string) => void,\n\t\ttitle?: string | DNode\n\t) => {\n\t\tconst { theme, classes } = this.properties;\n\t\treturn w(TextInput, {\n\t\t\tkey: 'filter',\n\t\t\ttheme,\n\t\t\tclasses,\n\t\t\textraClasses: { root: css.filter },\n\t\t\tlabel: `Filter by ${title}`,\n\t\t\tlabelHidden: true,\n\t\t\ttype: 'search',\n\t\t\tvalue: filterValue,\n\t\t\tonInput: doFilter\n\t\t});\n\t};\n\n\tprotected render(): DNode {\n\t\tconst {\n\t\t\tcolumnConfig,\n\t\t\tsort,\n\t\t\tfilterer,\n\t\t\tfilter = {},\n\t\t\tsortRenderer = this._sortRenderer,\n\t\t\tfilterRenderer = this._filterRenderer\n\t\t} = this.properties;\n\n\t\treturn v(\n\t\t\t'div',\n\t\t\t{ classes: [this.theme(css.root), fixedCss.rootFixed], role: 'row' },\n\t\t\tcolumnConfig.map((column) => {\n\t\t\t\tconst title = this._getColumnTitle(column);\n\t\t\t\tlet headerProperties = {};\n\t\t\t\tconst isSorted = sort && sort.columnId === column.id;\n\t\t\t\tconst isSortedAsc = Boolean(\n\t\t\t\t\tsort && sort.columnId === column.id && sort.direction === 'asc'\n\t\t\t\t);\n\t\t\t\tif (column.sortable) {\n\t\t\t\t\theaderProperties = {\n\t\t\t\t\t\tclasses: [\n\t\t\t\t\t\t\tthis.theme(css.sortable),\n\t\t\t\t\t\t\tisSorted ? this.theme(css.sorted) : null,\n\t\t\t\t\t\t\tisSorted && !isSortedAsc ? this.theme(css.desc) : null,\n\t\t\t\t\t\t\tisSortedAsc ? this.theme(css.asc) : null\n\t\t\t\t\t\t],\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis._sortColumn(column.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tconst filterKeys = Object.keys(filter);\n\t\t\t\tconst direction = !isSorted ? undefined : isSortedAsc ? 'asc' : 'desc';\n\t\t\t\tconst filterValue = filterKeys.indexOf(column.id) > -1 ? filter[column.id] : '';\n\t\t\t\tconst doFilter = (value: string) => {\n\t\t\t\t\tfilterer(column.id, value);\n\t\t\t\t};\n\n\t\t\t\treturn v(\n\t\t\t\t\t'div',\n\t\t\t\t\t{\n\t\t\t\t\t\t'aria-sort': isSorted ? (isSortedAsc ? 'ascending' : 'descending') : null,\n\t\t\t\t\t\tclasses: [this.theme(css.cell), fixedCss.cellFixed],\n\t\t\t\t\t\trole: 'columnheader'\n\t\t\t\t\t},\n\t\t\t\t\t[\n\t\t\t\t\t\tv('div', headerProperties, [\n\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\tcolumn.sortable\n\t\t\t\t\t\t\t\t? sortRenderer(column, direction, () => {\n\t\t\t\t\t\t\t\t\t\tthis._sortColumn(column.id);\n\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t]),\n\t\t\t\t\t\tcolumn.filterable\n\t\t\t\t\t\t\t? filterRenderer(column, filterValue, doFilter, title)\n\t\t\t\t\t\t\t: null\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t})\n\t\t);\n\t}\n}\n"]}