{"version":3,"file":"/Users/mwistrand/projects/dojo/widgets/src/global-event/index.ts","sourceRoot":"","sources":["../node_modules/tslint-loader/index.js??ref--4!/Users/mwistrand/projects/dojo/widgets/node_modules/@dojo/webpack-contrib/css-module-dts-loader/index.js?type=ts&instanceName=0_custom-elements!/Users/mwistrand/projects/dojo/widgets/src/global-event/index.ts"],"names":[],"mappings":";AAAA,OAAO,MAAM,MAAM,6BAA6B,CAAC;AACjD,OAAO,UAAU,MAAM,wCAAwC,CAAC;AAEhE,OAAO,EAAE,YAAY,EAAE,MAAM,qDAAqD,CAAC;AACnF,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAC;AAgB3D,MAAM,kBAAmB,SAAQ,UAAiC;IAAlE;;QACS,eAAU,GAAwB;YACzC,MAAM,EAAE,EAAE;YACV,QAAQ,EAAE,EAAE;SACZ,CAAC;IAoEH,CAAC;IAlEQ,kBAAkB,CACzB,IAA2B,EAC3B,iBAAsC,EACtC,YAAiC;QAEjC,MAAM,mBAAmB,GAAmB,EAAE,CAAC;QAC/C,iBAAiB,CAAC,IAAI,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,EAAE;gBAC1D,MAAM,WAAW,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC;gBAClD,EAAE,CAAC,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC;oBAC/B,MAAM,CAAC,IAAI,CAAC,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;gBAC/E,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;oBAC/D,MAAM,CAAC,IAAI,CAAC,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;oBAC9E,MAAM,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;oBACtD,mBAAmB,CAAC,SAAS,CAAC,GAAG,WAAW,CAAC;gBAC9C,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACP,mBAAmB,CAAC,SAAS,CAAC,GAAG,WAAW,CAAC;gBAC9C,CAAC;YACF,CAAC,CAAC,CAAC;QAEJ,YAAY,CAAC,IAAI,CAAC;YACjB,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,EAAE;gBACrD,EAAE,CAAC,CACF,iBAAiB,CAAC,IAAI,CAAC,KAAK,SAAS;oBACrC,iBAAiB,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,SACxC,CAAC,CAAC,CAAC;oBACF,MAAM,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,SAAS,EAAE,YAAY,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;oBACxE,mBAAmB,CAAC,SAAS,CAAC,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC;gBAChE,CAAC;YACF,CAAC,CAAC,CAAC;QACJ,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,mBAAmB,CAAC;IAC7C,CAAC;IAEO,6BAA6B,CAAC,IAA2B;QAChE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,EAAE;YACxD,MAAM,CAAC,IAAI,CAAC,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;QAC/E,CAAC,CAAC,CAAC;IACJ,CAAC;IAGS,uBAAuB,CAChC,iBAAsC,EACtC,YAAiC;QAEjC,IAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE,iBAAiB,EAAE,YAAY,CAAC,CAAC;IACpE,CAAC;IAGS,yBAAyB,CAClC,iBAAsC,EACtC,YAAiC;QAEjC,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,iBAAiB,EAAE,YAAY,CAAC,CAAC;IACtE,CAAC;IAES,QAAQ;QACjB,IAAI,CAAC,6BAA6B,CAAC,QAAQ,CAAC,CAAC;QAC7C,IAAI,CAAC,6BAA6B,CAAC,UAAU,CAAC,CAAC;IAChD,CAAC;IAES,MAAM;QACf,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAC9B,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;QACtB,CAAC;QACD,MAAM,CAAC,IAAI,CAAC;IACb,CAAC;CACD;AA1BA;IADC,YAAY,CAAC,QAAQ,EAAE,OAAO,CAAC;;;;0DAM/B;AAGD;IADC,YAAY,CAAC,UAAU,EAAE,OAAO,CAAC;;;;4DAMjC;AAeF,eAAe,WAAW,CAAC","sourcesContent":["import global from '@dojo/framework/shim/global';\nimport WidgetBase from '@dojo/framework/widget-core/WidgetBase';\nimport { DNode } from '@dojo/framework/widget-core/interfaces';\nimport { diffProperty } from '@dojo/framework/widget-core/decorators/diffProperty';\nimport { shallow } from '@dojo/framework/widget-core/diff';\n\nexport interface ListenerObject {\n\t[index: string]: (event?: any) => void;\n}\n\nexport interface GlobalEventProperties extends Partial<RegisteredListeners> {\n\twindow?: ListenerObject;\n\tdocument?: ListenerObject;\n}\n\nexport interface RegisteredListeners {\n\twindow: ListenerObject;\n\tdocument: ListenerObject;\n}\n\nexport class GlobalEvent extends WidgetBase<GlobalEventProperties> {\n\tprivate _listeners: RegisteredListeners = {\n\t\twindow: {},\n\t\tdocument: {}\n\t};\n\n\tprivate _registerListeners(\n\t\ttype: 'window' | 'document',\n\t\tpreviousListeners: RegisteredListeners,\n\t\tnewListeners: RegisteredListeners\n\t) {\n\t\tconst registeredListeners: ListenerObject = {};\n\t\tpreviousListeners[type] &&\n\t\t\tObject.keys(previousListeners[type]).forEach((eventName) => {\n\t\t\t\tconst newListener = newListeners[type][eventName];\n\t\t\t\tif (newListener === undefined) {\n\t\t\t\t\tglobal[type].removeEventListener(eventName, this._listeners[type][eventName]);\n\t\t\t\t} else if (previousListeners[type][eventName] !== newListener) {\n\t\t\t\t\tglobal[type].removeEventListener(eventName, this._listeners[type][eventName]);\n\t\t\t\t\tglobal[type].addEventListener(eventName, newListener);\n\t\t\t\t\tregisteredListeners[eventName] = newListener;\n\t\t\t\t} else {\n\t\t\t\t\tregisteredListeners[eventName] = newListener;\n\t\t\t\t}\n\t\t\t});\n\n\t\tnewListeners[type] &&\n\t\t\tObject.keys(newListeners[type]).forEach((eventName) => {\n\t\t\t\tif (\n\t\t\t\t\tpreviousListeners[type] === undefined ||\n\t\t\t\t\tpreviousListeners[type][eventName] === undefined\n\t\t\t\t) {\n\t\t\t\t\tglobal[type].addEventListener(eventName, newListeners[type][eventName]);\n\t\t\t\t\tregisteredListeners[eventName] = newListeners[type][eventName];\n\t\t\t\t}\n\t\t\t});\n\t\tthis._listeners[type] = registeredListeners;\n\t}\n\n\tprivate _removeAllRegisteredListeners(type: 'window' | 'document') {\n\t\tObject.keys(this._listeners[type]).forEach((eventName) => {\n\t\t\tglobal[type].removeEventListener(eventName, this._listeners[type][eventName]);\n\t\t});\n\t}\n\n\t@diffProperty('window', shallow)\n\tprotected onWindowListenersChange(\n\t\tpreviousListeners: RegisteredListeners,\n\t\tnewListeners: RegisteredListeners\n\t) {\n\t\tthis._registerListeners('window', previousListeners, newListeners);\n\t}\n\n\t@diffProperty('document', shallow)\n\tprotected onDocumentListenersChange(\n\t\tpreviousListeners: RegisteredListeners,\n\t\tnewListeners: RegisteredListeners\n\t) {\n\t\tthis._registerListeners('document', previousListeners, newListeners);\n\t}\n\n\tprotected onDetach() {\n\t\tthis._removeAllRegisteredListeners('window');\n\t\tthis._removeAllRegisteredListeners('document');\n\t}\n\n\tprotected render(): DNode | DNode[] {\n\t\tif (this.children.length > 0) {\n\t\t\treturn this.children;\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport default GlobalEvent;\n"]}